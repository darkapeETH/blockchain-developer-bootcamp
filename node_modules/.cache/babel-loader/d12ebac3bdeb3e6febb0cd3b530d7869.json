{"ast":null,"code":"import { createSelector } from 'reselect';\nimport { get } from 'lodash';\nimport { ethers } from 'ethers';\n\nconst tokens = state => get(state, 'tokens.contracts');\n\nconst allOrders = state => get(state, 'exchange.allOrders.data', []);\n\nconst decorateOrder = (order, tokens) => {\n  let token0Amount, token1Amount;\n\n  if (order.tokenGive === tokens[1].address) {\n    token0Amount = order.amountGive;\n    token1Amount = order.amountGet;\n  } else {\n    token0Amount = order.amountGet;\n    token1Amount = order.amountGive;\n  }\n\n  let tokenPrice = token1Amount / token0Amount;\n  math.round(tokenPrice * 100000) / 100000;\n  return { ...order,\n    token0Amount: ethers.utils.formatUnits(token0Amount, 'ether'),\n    token1Amount: ethers.utils.formatUnits(token1Amount, 'ether'),\n    tokenPrice: ethers.utils.formatUnits(tokenPrice, 'ether')\n  };\n}; //Order Book\n\n\nexport const orderBookSelector = createSelector(allOrders, tokens, (orders, tokens) => {\n  if (!tokens[0] || !tokens[1]) {\n    return;\n  }\n\n  orders = orders.filter(o => o.tokenGet === tokens[0].address || o.tokenGet === tokens[1].address);\n  orders = orders.filter(o => o.tokenGive === tokens[0].address || o.tokenGive === tokens[1].address); //Decorate the order\n\n  orders.map(order => {\n    let o = decorateOrder(order, tokens);\n    console.log(o);\n  });\n});","map":{"version":3,"names":["createSelector","get","ethers","tokens","state","allOrders","decorateOrder","order","token0Amount","token1Amount","tokenGive","address","amountGive","amountGet","tokenPrice","math","round","utils","formatUnits","orderBookSelector","orders","filter","o","tokenGet","map","console","log"],"sources":["/mnt/c/pr0/blockchain-developer-bootcamp/src/store/selectors.js"],"sourcesContent":["import { createSelector } from 'reselect'\r\nimport { get } from 'lodash'\r\nimport { ethers } from 'ethers'\r\n\r\nconst tokens = state => get(state, 'tokens.contracts')\r\nconst allOrders = state => get(state, 'exchange.allOrders.data', [])\r\nconst decorateOrder =  (order, tokens) => {\r\n\tlet token0Amount, token1Amount\r\n\r\n\tif (order.tokenGive === tokens[1].address) {\r\n\t\ttoken0Amount = order.amountGive\r\n\t\ttoken1Amount = order.amountGet\r\n\t} else {\r\n\t\ttoken0Amount = order.amountGet\r\n\t\ttoken1Amount = order.amountGive\t\t\r\n\t}\r\n\tlet tokenPrice = (token1Amount / token0Amount)\r\n\tmath.round(tokenPrice* 100000) / 100000\r\n\r\n\treturn ({\r\n\t\t...order,\r\n\t\ttoken0Amount: ethers.utils.formatUnits(token0Amount,'ether'),\r\n\t\ttoken1Amount: ethers.utils.formatUnits(token1Amount,'ether'),\r\n\t\ttokenPrice: ethers.utils.formatUnits(tokenPrice,'ether')\r\n\t})\r\n}\r\n\r\n//Order Book\r\nexport const orderBookSelector = createSelector(\r\n\tallOrders,\r\n\ttokens,\r\n\t(orders, tokens) =>{\r\n\t\tif (!tokens[0] || !tokens[1]) {return}\r\n\r\n\t\torders = orders.filter((o) => o.tokenGet === tokens[0].address || o.tokenGet === tokens[1].address)\r\n\t\torders = orders.filter((o) => o.tokenGive === tokens[0].address || o.tokenGive === tokens[1].address)\r\n\r\n\t//Decorate the order\r\n\torders.map((order) =>{\r\n\t\tlet o = decorateOrder(order, tokens)\r\n\t\tconsole.log(o)\r\n\t})\r\n}) "],"mappings":"AAAA,SAASA,cAAT,QAA+B,UAA/B;AACA,SAASC,GAAT,QAAoB,QAApB;AACA,SAASC,MAAT,QAAuB,QAAvB;;AAEA,MAAMC,MAAM,GAAGC,KAAK,IAAIH,GAAG,CAACG,KAAD,EAAQ,kBAAR,CAA3B;;AACA,MAAMC,SAAS,GAAGD,KAAK,IAAIH,GAAG,CAACG,KAAD,EAAQ,yBAAR,EAAmC,EAAnC,CAA9B;;AACA,MAAME,aAAa,GAAI,CAACC,KAAD,EAAQJ,MAAR,KAAmB;EACzC,IAAIK,YAAJ,EAAkBC,YAAlB;;EAEA,IAAIF,KAAK,CAACG,SAAN,KAAoBP,MAAM,CAAC,CAAD,CAAN,CAAUQ,OAAlC,EAA2C;IAC1CH,YAAY,GAAGD,KAAK,CAACK,UAArB;IACAH,YAAY,GAAGF,KAAK,CAACM,SAArB;EACA,CAHD,MAGO;IACNL,YAAY,GAAGD,KAAK,CAACM,SAArB;IACAJ,YAAY,GAAGF,KAAK,CAACK,UAArB;EACA;;EACD,IAAIE,UAAU,GAAIL,YAAY,GAAGD,YAAjC;EACAO,IAAI,CAACC,KAAL,CAAWF,UAAU,GAAE,MAAvB,IAAiC,MAAjC;EAEA,OAAQ,EACP,GAAGP,KADI;IAEPC,YAAY,EAAEN,MAAM,CAACe,KAAP,CAAaC,WAAb,CAAyBV,YAAzB,EAAsC,OAAtC,CAFP;IAGPC,YAAY,EAAEP,MAAM,CAACe,KAAP,CAAaC,WAAb,CAAyBT,YAAzB,EAAsC,OAAtC,CAHP;IAIPK,UAAU,EAAEZ,MAAM,CAACe,KAAP,CAAaC,WAAb,CAAyBJ,UAAzB,EAAoC,OAApC;EAJL,CAAR;AAMA,CAnBD,C,CAqBA;;;AACA,OAAO,MAAMK,iBAAiB,GAAGnB,cAAc,CAC9CK,SAD8C,EAE9CF,MAF8C,EAG9C,CAACiB,MAAD,EAASjB,MAAT,KAAmB;EAClB,IAAI,CAACA,MAAM,CAAC,CAAD,CAAP,IAAc,CAACA,MAAM,CAAC,CAAD,CAAzB,EAA8B;IAAC;EAAO;;EAEtCiB,MAAM,GAAGA,MAAM,CAACC,MAAP,CAAeC,CAAD,IAAOA,CAAC,CAACC,QAAF,KAAepB,MAAM,CAAC,CAAD,CAAN,CAAUQ,OAAzB,IAAoCW,CAAC,CAACC,QAAF,KAAepB,MAAM,CAAC,CAAD,CAAN,CAAUQ,OAAlF,CAAT;EACAS,MAAM,GAAGA,MAAM,CAACC,MAAP,CAAeC,CAAD,IAAOA,CAAC,CAACZ,SAAF,KAAgBP,MAAM,CAAC,CAAD,CAAN,CAAUQ,OAA1B,IAAqCW,CAAC,CAACZ,SAAF,KAAgBP,MAAM,CAAC,CAAD,CAAN,CAAUQ,OAApF,CAAT,CAJkB,CAMnB;;EACAS,MAAM,CAACI,GAAP,CAAYjB,KAAD,IAAU;IACpB,IAAIe,CAAC,GAAGhB,aAAa,CAACC,KAAD,EAAQJ,MAAR,CAArB;IACAsB,OAAO,CAACC,GAAR,CAAYJ,CAAZ;EACA,CAHD;AAIA,CAd8C,CAAxC"},"metadata":{},"sourceType":"module"}